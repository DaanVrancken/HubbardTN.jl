<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · HubbardTN.jl</title><meta name="title" content="Examples · HubbardTN.jl"/><meta property="og:title" content="Examples · HubbardTN.jl"/><meta property="twitter:title" content="Examples · HubbardTN.jl"/><meta name="description" content="Documentation for HubbardTN.jl."/><meta property="og:description" content="Documentation for HubbardTN.jl."/><meta property="twitter:description" content="Documentation for HubbardTN.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">HubbardTN.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../Functions/">Library</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Initialization"><span>Initialization</span></a></li><li><a class="tocitem" href="#One-band"><span>One-band</span></a></li><li><a class="tocitem" href="#Multi-band"><span>Multi-band</span></a></li><li><a class="tocitem" href="#Ground-state"><span>Ground state</span></a></li><li><a class="tocitem" href="#Excited-states"><span>Excited states</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/DaanVrancken/HubbardTN.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/DaanVrancken/HubbardTN.jl/blob/master/docs/src/Examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><p>Several examples can be found in the &quot;examples&quot; folder of the repository. In this tutorial, we elaborate on some of the details.</p><h2 id="Initialization"><a class="docs-heading-anchor" href="#Initialization">Initialization</a><a id="Initialization-1"></a><a class="docs-heading-anchor-permalink" href="#Initialization" title="Permalink"></a></h2><p>To make use of the functionalities, we first need to import the package</p><pre><code class="nohighlight hljs">julia&gt; using HubbardTN</code></pre><p>We also define a directory where we want to store our output data</p><pre><code class="nohighlight hljs">julia&gt; path = &quot;output&quot;</code></pre><p>This will allow us to load previously calculated states at a later time or compute excited states without having to recompute the ground state, for example.</p><h2 id="One-band"><a class="docs-heading-anchor" href="#One-band">One-band</a><a id="One-band-1"></a><a class="docs-heading-anchor-permalink" href="#One-band" title="Permalink"></a></h2><p>Each Hubbard model is linked to a structure, storing all its major properties. The first question we ask ourselves is whether we want to conserve the number of electrons by imposing a <span>$U(1)$</span> symmetry, or if we want to add a chemical potential to deal with this. The first we achieve by using the <code>OB_Sim()</code> structure, the latter with <code>OBC_Sim()</code>.</p><p>The most important properties of <code>OB_Sim()</code> are the hoppig <code>t</code>, the Hubbard <code>u</code>, the chemical potential <code>µ</code>, and the filling defined by the ratio <code>P</code>/<code>Q</code>.</p><pre><code class="nohighlight hljs">s = 2.5             # Schmidt cut value, determines bond dimension.
P = 1;              # Filling of P/Q. P/Q = 1 is half-filling.
Q = 1;
bond_dim = 20;      # Initial bond dimension of the state. Impact on result is small as DMRG modifies it.

# Define hopping, direct interaction, and chemical potential.
t=[1.0, 0.1];
u=[8.0];
μ=0.0;

# Spin=false will use SU(2) spin symmetry, the exact spin configuration cannot be deduced.
Spin = false

model = OB_Sim(t, u, μ, P, Q, s, bond_dim; spin=Spin);</code></pre><p><code>t</code> is a vector where the first element is the nearest neighbour hopping, the second the next-nearest neighbour hopping, and so on. Similarly, the first element of <code>u</code> is the on-site Coulomb repulsion and the second element the interaction between two neighbouring sites. </p><p>The Schmidt cut <code>s</code> determines to which value the bond dimension is grown by the iDMRG2 algorithm, while <code>bond_dim</code> is the maximal value used for the initialization of the MPS.</p><blockquote><p><strong>NOTE:</strong> In order to preserve injectivity, a unit cell of size <code>Q</code> is used if <code>P</code>is even and of size <code>2*Q</code> if <code>P</code> is odd. Therefore, filling ratios that deviate from half filling <code>P=Q=1</code> tend to be more computationally intensive.</p></blockquote><p>Finally, the tag <code>spin</code> determines if spin up and down have to be treated independently. If <code>spin=false</code>, an additional <span>$SU(2)$</span> symmetry is imposed, reducing the local Hilbert space dimension to 3 and leading to a substantial speed up. However, no information about the spin of a state can be retrieved.</p><p><code>OBC_Sim()</code> works similarly. Now, we either provide a chemical potential or a filling.</p><pre><code class="nohighlight hljs">model_OBC_1 = OBC_Sim(t, u, P/Q, s, bond_dim; mu=false)
model_OBC_2 = OBC_Sim(t, u, μ, s, bond_dim; mu=true)</code></pre><p>If a filling is defined, the corresponding chemical potential is sought iteratively. Calculations without spin symmetry are not yet implemented.</p><h2 id="Multi-band"><a class="docs-heading-anchor" href="#Multi-band">Multi-band</a><a id="Multi-band-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-band" title="Permalink"></a></h2><p>In analogy with the one-band model, multi-band models can be constructed using <code>MB_Sim()</code> or <code>MBC_Sim()</code>. For the one-band model, DrWatson.jl is able to find a unique name for the model based on its parameters. This name is later used to retrieve earlier computed results. For multi-band models, the number of parameters is simply too large and we have to provide a unique name ourselves, like the name of the script for instance.</p><pre><code class="nohighlight hljs">name_jl = last(splitpath(Base.source_path()))
name = first(split(name_jl,&quot;.&quot;))</code></pre><p>Then, we insert the parameters in the form of <span>$B\times B$</span> matrices, where <span>$B$</span> is the number of bands. For a 2-band model this looks as follows</p><pre><code class="nohighlight hljs">s = 2.5             # Schmidt cut value, determines bond dimension.
P = 1;              # Filling of P/Q. P/Q = 1 is half-filling.
Q = 1;
bond_dim = 20;      # Initial bond dimension of the state. Impact on result is small as DMRG modifies it.

# Define hopping, direct and exchange interaction matrices.
t_onsite = [0.000 3.803; 3.803 0.000];
t_intersite = [-0.548 0.000;2.977 -0.501];
t = cat(t_onsite,t_intersite, dims=2);
U = [10.317 6.264 0.000 0.000; 6.264 10.317 6.162 0.000];
J = [0.000 0.123 0.000 0.000; 0.123 0.000 0.113 0.000];
U13 = zeros(2,2)

model = MB_Sim(t, U, J, U13, P, Q, s, bond_dim; code = name);</code></pre><p>Where the one-band model used vectors for <code>t</code> and <code>u</code>, the multi-band model concatenates matrices horizontally. In addition, the exchange <span>$J$</span> and <span>$U_{ijjj}$</span> parameters, with zeros on the diagonals as these are included in <code>u</code>, are implemented as well. Since those parameters are usually rather small, <code>U13</code> is an optional argument. Furthermore, parameters of the form <span>$U_{ijkk}$</span> and <span>$U_{ijkl}$</span> can be implemented by providing dictionaries as kwargs tot the structure</p><pre><code class="nohighlight hljs">U112 = Dict((1,1,2,3) =&gt; 0.0, (1,2,4,2) =&gt; 0.0) # and so on ...
U1111 = Dict((1,2,3,4) =&gt; 0.0, (3,2,4,1) =&gt; 0.0) # ...
model = MB_Sim(t, U, J, U13, P, Q, s, bond_dim; code = name, U112=U112, U1111=U1111)</code></pre><p>An index <span>$i$</span> larger than <span>$B$</span> corresponds to band <span>$i$</span> modulo <span>$B$</span> on site <span>$⌊i/B⌋$</span>.</p><p>For a <code>MBC_Sim()</code> structure, we would have</p><pre><code class="nohighlight hljs">model_MBC = MBC_Sim(t, u, J, s, bond_dim; code=name);</code></pre><p>The chemical potential is included in the diagonal terms of <code>t_onsite</code>. Iterative determination of the chemical potential for a certain filling is not yet supported.</p><h2 id="Ground-state"><a class="docs-heading-anchor" href="#Ground-state">Ground state</a><a id="Ground-state-1"></a><a class="docs-heading-anchor-permalink" href="#Ground-state" title="Permalink"></a></h2><p>The ground state of a model is computed (or loaded if it has been computed before) by the function <code>produce_groundstate()</code>. We can then extract the ground state energy as the expectation value of the Hamiltonian with respect to the ground state.</p><pre><code class="nohighlight hljs">dictionary = produce_groundstate(model; path=path);
ψ₀ = dictionary[&quot;groundstate&quot;];
H = dictionary[&quot;ham&quot;];
E0 = expectation_value(ψ₀, H);
E = real(E0)./length(H);
println(&quot;Groundstate energy: $E&quot;)</code></pre><p>Other properties, such as the bond dimension, the electron density and spin density (if it was a calculation without SU(2) symmetry), can be calculated as well.</p><pre><code class="nohighlight hljs">println(&quot;Bond dimension: $(dim_state(ψ₀))&quot;)
println(&quot;Electron density: $(density_state(ψ₀))&quot;)
println(&quot;Spin density: $(density_spin(ψ₀))&quot;)</code></pre><blockquote><p><strong>NOTE:</strong> When the parameters are changed but you want to keep the name of the model the same, you should put <code>force=true</code> to overwrite the previous results, obtained with the old parameters, or store the calculation at a different <code>path</code>. Be cautious for accidentally overwriting data that you want to keep!</p></blockquote><h2 id="Excited-states"><a class="docs-heading-anchor" href="#Excited-states">Excited states</a><a id="Excited-states-1"></a><a class="docs-heading-anchor-permalink" href="#Excited-states" title="Permalink"></a></h2><p>To compute quasiparticle excitations we have to choose the momentum, the number of excitations, and the symmetry sectors. </p><pre><code class="nohighlight hljs">resolution = 5;
momenta = range(0, π, resolution);
nums = 1;

exc = produce_excitations(model, momenta, nums; charges=[0,0.0,0], path=path);
Es = exc[&quot;Es&quot;];
println(&quot;Excitation energies: &quot;)
println(Es)</code></pre><p>Excitations in the same sector as the ground state are found by defining <code>charges</code> as zeros. These charges refer to the difference with the ground state. Be aware that the meaning of the charges in this vector differ depending on the symmetries and thus on the type of model. <code>OBC_Sim</code> and <code>MBC_Sim</code> even have only two symmetries, and hence, two charges.</p><p>For example, a spin symmetric, electron conserving model has symmetry <span>$\mathbb{Z}_2\times SU(2)\times U(1)$</span>. Sectors obtained by adding a particle or hole differ by <code>charges = [1,1/2,+/-1]</code>. These single-particle excitations allow for the calculation of the band gap.</p><pre><code class="nohighlight hljs">gap, k = produce_bandgap(model; path=path)
println(&quot;Band Gap for s=$s: $gap eV at momentum $k&quot;)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Functions/">« Library</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 10 October 2025 09:38">Friday 10 October 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
